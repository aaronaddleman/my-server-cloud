{
  "name": "openstack-identity",
  "description": "The OpenStack Identity service Keystone.",
  "long_description": "Description\n===========\n\nThis cookbook installs the OpenStack Identity Service **Keystone** as part of the OpenStack reference deployment Chef for OpenStack. The https://github.com/openstack/openstack-chef-repo contains documentation for using this cookbook in the context of a full OpenStack deployment. Keystone is installed from packages, creating the default user, tenant, and roles. It also registers the identity service and identity endpoint.\n\nhttp://keystone.openstack.org/\n\nRequirements\n============\n\nChef 0.10.0 or higher required (for Chef environment use)\n\nCookbooks\n---------\n\nThe following cookbooks are dependencies:\n\n* openstack-common\n\nUsage\n=====\n\nclient\n------\n\nInstalls the keystone client packages\n\n\nserver (deprecated, will be removed in M release)\n------\n\nInstalls and Configures Keystone Service\n\n```json\n\"run_list\": [\n    \"recipe[openstack-identity::server]\"\n]\n```\n\nserver-apache\n-------------\n\nInstalls and Configures Keystone Service under Apache\n\n```json\n\"run_list\": [\n    \"recipe[openstack-identity::server-apache]\"\n]\n```\n\nResources/Providers\n===================\n\nThese resources provide an abstraction layer for interacting with the keystone server's API, allowing for other nodes to register any required users, tenants, roles, services, or endpoints.\n\nregister\n--------\n\nRegister users, tenants, roles, services and endpoints with Keystone\n\n### Actions\n\n- :create_tenant: Create a tenant\n- :create_user: Create a user for a specified tenant\n- :create_role: Create a role\n- :grant_role: Grant a role to a specified user for a specified tenant\n- :create_service: Create a service\n- :create_endpoint: Create an endpoint for a sepcified service\n\n### General Attributes\n\n- auth_protocol: Required communication protocol with Keystone server\n - Acceptable values are [ \"http\", \"https\" ]\n- auth_host: Keystone server IP Address\n- auth_port: Port Keystone server is listening on\n- api_ver: API Version for Keystone server\n - Accepted values are [ \"/v2.0\" ]\n- auth_token: Auth Token for communication with Keystone server\n- misc_keystone: Array of strings to be added to the keystone.conf file\n\n### :create_tenant Specific Attributes\n\n- tenant_name: Name of tenant to create\n- tenant_description: Description of tenant to create\n- tenant_enabled: Enable or Disable tenant\n - Accepted values are [ \"true\", \"false\" ]\n - Default is \"true\"\n\n### :create_user Specific Attributes\n\n- user_name: Name of user account to create\n- user_pass: Password for the user account\n- user_enabled: Enable or Disable user\n - Accepted values are [ \"true\", \"false\" ]\n - Default is \"true\"\n- tenant_name: Name of tenant to create user in\n\n### :create_role Specific Attributes\n\n- role_name: Name of the role to create\n\n### :grant_role Specific Attributes\n\n- role_name: Name of the role to grant\n- user_name: User name to grant the role to\n- tenant_name: Name of tenant to grant role in\n\n### :create_service Specific Attributes\n\n- service_name: Name of service\n- service_description: Description of service\n- service_type: Type of service to create\n - Accepted values are [ \"image\", \"identity\", \"compute\", \"storage\", \"ec2\", \"volume\", \"object-store\", \"metering\", \"network\", \"orchestration\", \"cloudformation\" ]\n- **NOTE:** call will be skipped if `openstack['identity']['catalog']['backend']` is set to 'templated'\n\n### :create_endpoint Specific Attributes\n\n- endpoint_region: Default value is \"RegionOne\"\n- endpoint_adminurl: URL to admin endpoint (using admin port)\n- endpoint_internalurl: URL to service endpoint (using service port)\n- endpoint_publicurl: URL to public endpoint\n - Default is same as endpoint_internalURL\n- service_type: Type of service to create endpoint for\n - Accepted values are [ \"image\", \"identity\", \"compute\", \"storage\", \"ec2\", \"volume\", \"object-store\", \"metering\", \"network\", \"orchestration\", \"cloudformation\" ]\n- **NOTE:** call will be skipped if `openstack['identity']['catalog']['backend']` is set to 'templated'\n\n### Examples\n\n    # Create 'openstack' tenant\n    openstack_identity_register \"Register 'openstack' Tenant\" do\n      auth_host \"192.168.1.10\"\n      auth_port \"35357\"\n      auth_protocol \"http\"\n      api_ver \"/v2.0\"\n      auth_token \"123456789876\"\n      tenant_name \"openstack\"\n      tenant_description \"Default Tenant\"\n      tenant_enabled \"true\" # Not required as this is the default\n      action :create_tenant\n    end\n\n    # Create 'admin' user\n    openstack_identity_register \"Register 'admin' User\" do\n      auth_host \"192.168.1.10\"\n      auth_port \"35357\"\n      auth_protocol \"http\"\n      api_ver \"/v2.0\"\n      auth_token \"123456789876\"\n      tenant_name \"openstack\"\n      user_name \"admin\"\n      user_pass \"secrete\"\n      user_enabled \"true\" # Not required as this is the default\n      action :create_user\n    end\n\n    # Create 'admin' role\n    openstack_identity_register \"Register 'admin' Role\" do\n      auth_host \"192.168.1.10\"\n      auth_port \"35357\"\n      auth_protocol \"http\"\n      api_ver \"/v2.0\"\n      auth_token \"123456789876\"\n      role_name role_key\n      action :create_role\n    end\n\n\n    # Grant 'admin' role to 'admin' user in the 'openstack' tenant\n    openstack_identity_register \"Grant 'admin' Role to 'admin' User\" do\n      auth_host \"192.168.1.10\"\n      auth_port \"35357\"\n      auth_protocol \"http\"\n      api_ver \"/v2.0\"\n      auth_token \"123456789876\"\n      tenant_name \"openstack\"\n      user_name \"admin\"\n      role_name \"admin\"\n      action :grant_role\n    end\n\n    # Create 'identity' service\n    openstack_identity_register \"Register Identity Service\" do\n      auth_host \"192.168.1.10\"\n      auth_port \"35357\"\n      auth_protocol \"http\"\n      api_ver \"/v2.0\"\n      auth_token \"123456789876\"\n      service_name \"keystone\"\n      service_type \"identity\"\n      service_description \"Keystone Identity Service\"\n      action :create_service\n    end\n\n    # Create 'identity' endpoint\n    openstack_identity_register \"Register Identity Endpoint\" do\n      auth_host \"192.168.1.10\"\n      auth_port \"35357\"\n      auth_protocol \"http\"\n      api_ver \"/v2.0\"\n      auth_token \"123456789876\"\n      service_type \"identity\"\n      endpoint_region \"RegionOne\"\n      endpoint_adminurl \"http://192.168.1.10:35357/v2.0\"\n      endpoint_internalurl \"http://192.168.1.10:5001/v2.0\"\n      endpoint_publicurl \"http://1.2.3.4:5001/v2.0\"\n      action :create_endpoint\n    end\n\ncredentials\n-----------\n\nCreate EC2 credentials for a given user in the specified tenant\n\n### Actions\n\n- :create_ec2: create EC2 credentials\n\n### General Attributes\n\n- auth_protocol: Required communication protocol with Keystone server. Acceptable values are [ \"http\", \"https\" ]\n- auth_host: Keystone server IP Address\n- auth_port: Port Keystone server is listening on\n- api_ver: API Version for Keystone server\n - Accepted values are [ \"/v2.0\" ]\n- auth_token: Auth Token for communication with Keystone server\n\n### :create_ec2 Specific Attributes\n\n- user_name: User name to grant the credentials for\n- tenant_name: Tenant name to grant the credentials in\n\n### Examples\n\n    openstack_identity_credentials \"Create EC2 credentials for 'admin' user\" do\n      auth_host \"192.168.1.10\"\n      auth_port \"35357\"\n      auth_protocol \"http\"\n      api_ver \"/v2.0\"\n      auth_token \"123456789876\"\n      user_name \"admin\"\n      tenant_name \"openstack\"\n    end\n\nAttributes\n==========\n\nPlease refer to the Common cookbook for more attributes.\n\n* `openstack['identity']['db_server_chef_role']` - The name of the Chef role that knows about the db server\n* `openstack['identity']['user']` - User keystone runs as\n* `openstack['identity']['group']` - Group keystone runs as\n* `openstack['identity']['db']` - Name of keystone database\n* `openstack['identity']['db_user']` - Username for keystone database access\n* `openstack['identity']['db_passwd']` - Password for keystone database access\n* `openstack['identity']['db_ipaddress']` - IP address of the keystone database\n* `openstack['identity']['api_ipaddress']` - IP address for the keystone API to bind to. _TODO_: Rename to bind_address\n* `openstack['identity']['verbose']` - Enables/disables verbose output for keystone API server\n* `openstack['identity']['debug']` - Enables/disables debug output for keystone API server\n* `openstack['identity']['admin_token']` - Admin token for bootstraping keystone server\n* `openstack['identity']['admin_workers']` - The number of worker processes to serve the admin WSGI application\n* `openstack['identity']['public_workers']` - The number of worker processes to serve the public WSGI application\n* `openstack['identity']['roles']` - Array of roles to create in the keystone server\n* `openstack['identity']['users']` - Array of users to create in the keystone server\n* `openstack['identity']['pastefile_url']` - Specify the URL for a keystone-paste.ini file that will override the default packaged file\n* `openstack['identity']['token']['expiration']` - Token validity time in seconds\n* `openstack['identity']['token']['hash_algorithm']` - Hash algorithms to use for hashing PKI tokens\n* `openstack['identity']['catalog']['backend']` - Storage mechanism for the keystone service catalog\n* `openstack['identity'][\"control_exchange\"]` - The AMQP exchange to connect to if using RabbitMQ or Qpid, defaults to openstack\n* `openstack['identity']['rpc_backend']` - The messaging module to use\n* `openstack['identity']['rpc_thread_pool_size']` - Size of RPC thread pool\n* `openstack['identity']['rpc_conn_pool_size']` - Size of RPC connection pool\n* `openstack['identity']['rpc_response_timeout']` - Seconds to wait for a response from call or multicall\n* `openstack['identity']['ldap']['url']` - LDAP host URL (default: 'ldap://localhost')\n* `openstack['identity']['ldap']['user']` - LDAP bind DN (default: 'dc=Manager,dc=example,dc=com')\n* `openstack['identity']['ldap']['password']` - LDAP bind password (default: nil)\n* `openstack['identity']['ldap']['use_tls']` - Use TLS for LDAP (default: false)\n* `openstack['identity']['ldap']['tls_cacertfile']` - Path to CA cert file (default: nil)\n* `openstack['identity']['ldap']['tls_cacertdir']` - Path to CA cert directory (default: nil)\n* `openstack['identity']['ldap']['tls_req_cert']` - CA cert check ('demand', 'allow' or 'never', default: 'demand')\n* `openstack['identity']['misc_keystone']` - **Array of strings to be added to keystone.conf**\n* `openstack['identity']['list_limit']` - Maximum number of entities that will be returned in a collection\n* `openstack['identity']['assignment']['list_limit']` - Maximum number of entities that will be returned in a assignment collection\n* `openstack['identity']['catalog']['list_limit']` - Maximum number of entities that will be returned in a catalog collection\n* `openstack['identity']['identity']['list_limit']` - Maximum number of entities that will be returned in a identity collection\n* `openstack['identity']['policy']['list_limit']` - Maximum number of entities that will be returned in a policy collection\n* `openstack['identity']['pipeline']['public_api']` - Pipeline of identity public api\n* `openstack['identity']['pipeline']['admin_api']` - Pipeline of identity admin api\n* `openstack['identity']['pipeline']['api_v3']` - Pipeline of identity V3 api\n* `openstack['identity']['ssl']['enabled']` - Enable HTTPS Keystone API endpoint. Default is false\n* `openstack['identity']['ssl']['cert_required']` - When SSL is enabled this flag is used to require client certificate. Default is false.\n* `openstack['identity']['ssl']['basedir']` - Path to Keystone SSL directory\n* `openstack['identity']['ssl']['certfile']`- Cert file location\n* `openstack['identity']['ssl']['keyfile']` - Key file location\n* `openstack['identity']['ssl']['ca_certs']` - Path to CA certificate file\n\nMost `openstack['identity']['ldap']` attributes map directly to the corresponding config options in keystone.conf's `[ldap]` backend.  They are primarily used when configuring `openstack['identity']['identity']['backend']` and/or `openstack[\"identity\"][\"assignment\"][\"backend\"]` as `ldap` (both default to `sql`).\n\nThe `openstack['identity']['ldap']['use_tls']` option should not be used in conjunction with an `ldaps://` url.  When the latter is used (and `openstack['identity']['ldap']['use_tls'] = false`), the certificate path and validation will instead be subject to the OS's LDAP config.\n\nIf `openstack['identity']['ldap']['tls_cacertfile']` is set, `openstack['identity']['ldap']['tls_cacertdir']` will be ignored.  Set `openstack['identity']['ldap']['tls_cacertfile']` to `nil` if `openstack['identity']['ldap']['tls_cacertdir']` is desired.\nValues of `openstack['identity']['ldap']['tls_req_cert']` correspond to the standard options permitted by the TLS_REQCERT TLS option (`never` performs no validation of certs, `allow` performs some basic name checks but no thorough CA validation, `demand` requires the certificate chain to be valid for the connection to succeed).\n\nThe following attributes are defined in attributes/default.rb of the common cookbook, but are documented here due to their relevance:\n\n* `openstack['endpoints']['identity-bind']['host']` - The IP address to bind the identity services to\n* `openstack['endpoints']['identity-bind']['scheme']` - Unused\n* `openstack['endpoints']['identity-bind']['port']` - Unused\n* `openstack['endpoints']['identity-bind']['path']` - Unused\n* `openstack['endpoints']['identity-bind']['bind_interface']` - The interface name to bind the identity services to\n\nIf the value of the 'bind_interface' attribute is non-nil, then the identity service will be bound to the first IP address on that interface.  If the value of the 'bind_interface' attribute is nil, then the identity service will be bound to the IP address specified in the host attribute.\n\n### SSL enabling\nTo enable SSL on Keystone, a key and certficate must be created and installed on server running Keystone. The location of these files can be provided with the node attributes described above. Also, note that `openstack['endpoints']['identity-bind']['scheme']`, from openstack common cookbook, must be set to 'https' in order to enable SSL.\n\n### Token flushing\nWhen managing tokens with an SQL backend the token database may grow unboundedly as new tokens are issued and expired\ntokens are not disposed of. Expired tokens may need to be kept around in order to allow for auditability.\n\nIt is up to deployers to define when their tokens can be safely deleted. Keystone provides a tool to purge expired tokens,\nand the server recipe can create a cronjob to run that tool. By default the cronjob will be configured to run hourly.\n\nThe flush tokens cronjob configuration parameters are listed below:\n\n* `openstack['identity']['token_flush_cron']['enabled']` - Boolean indicating whether the flush tokens cronjob is enabled. It is by default enabled if the token backend is 'sql'.\n* `openstack['identity']['token_flush_cron']['log_file']` - The log file for the flush tokens tool.\n* `openstack['identity']['token_flush_cron']['hour']` - The hour at which the flush tokens cronjob should run (values 0 - 23).\n* `openstack['identity']['token_flush_cron']['minute']` - The minute at which the flush tokens cronjob should run (values 0 - 59).\n* `openstack']['identity']['token_flush_cron']['day']` - The day of the month when the flush tokens cronjob should run (values 1 - 31).\n* `openstack['identity']['token_flush_cron']['weekday']` = The day of the week at which the flush tokens cronjob should run (values 0 - 6, where Sunday is 0).\n\nTesting\n=====\n\nPlease refer to the [TESTING.md](TESTING.md) for instructions for testing the cookbook.\n\nBerkshelf\n=====\n\nBerks will resolve version requirements and dependencies on first run and\nstore these in Berksfile.lock. If new cookbooks become available you can run\n`berks update` to update the references in Berksfile.lock. Berksfile.lock will\nbe included in stable branches to provide a known good set of dependencies.\nBerksfile.lock will not be included in development branches to encourage\ndevelopment against the latest cookbooks.\n\nLicense and Author\n==================\n\nAuthor:: Justin Shepherd (<justin.shepherd@rackspace.com>)\nAuthor:: Jason Cannavale (<jason.cannavale@rackspace.com>)\nAuthor:: Ron Pedde (<ron.pedde@rackspace.com>)\nAuthor:: Joseph Breu (<joseph.breu@rackspace.com>)\nAuthor:: William Kelly (<william.kelly@rackspace.com>)\nAuthor:: Darren Birkett (<darren.birkett@rackspace.co.uk>)\nAuthor:: Evan Callicoat (<evan.callicoat@rackspace.com>)\nAuthor:: Matt Ray (<matt@opscode.com>)\nAuthor:: Jay Pipes (<jaypipes@att.com>)\nAuthor:: John Dewey (<jdewey@att.com>)\nAuthor:: Sean Gallagher (<sean.gallagher@att.com>)\nAuthor:: Ionut Artarisi (<iartarisi@suse.cz>)\nAuthor:: Chen Zhiwei (zhiwchen@cn.ibm.com)\nAuthor:: Eric Zhou (zyouzhou@cn.ibm.com)\nAuthor:: Jan Klare (j.klare@x-ion.de)\n\nCopyright 2012, Rackspace US, Inc.\nCopyright 2012-2013, Opscode, Inc.\nCopyright 2012-2013, AT&T Services, Inc.\nCopyright 2013-2014, SUSE Linux GmbH\nCopyright 2013-2014, IBM, Corp.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n",
  "maintainer": "openstack-chef",
  "maintainer_email": "opscode-chef-openstack@googlegroups.com",
  "license": "Apache 2.0",
  "platforms": {
    "ubuntu": ">= 0.0.0",
    "fedora": ">= 0.0.0",
    "redhat": ">= 0.0.0",
    "centos": ">= 0.0.0",
    "suse": ">= 0.0.0"
  },
  "dependencies": {
    "apache2": "~> 3.1.0",
    "openstack-common": ">= 11.5.0"
  },
  "recommendations": {
  },
  "suggestions": {
  },
  "conflicting": {
  },
  "providing": {
  },
  "replacing": {
  },
  "attributes": {
  },
  "groupings": {
  },
  "recipes": {
    "openstack-identity::client": "Install packages required for keystone client",
    "openstack-identity::server": "Installs and Configures Keystone Service",
    "openstack-identity::server-apache": "Installs and Configures Keystone Service under Apache",
    "openstack-identity::registration": "Adds user, tenant, role and endpoint records to Keystone"
  },
  "version": "11.1.0",
  "source_url": "",
  "issues_url": ""
}